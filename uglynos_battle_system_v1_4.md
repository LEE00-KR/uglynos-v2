# 🦖 어글리노스 (UglyNos) 전투 시스템 기획서

**버전:** v1.4  
**최종 수정일:** 2026-01-20  
**문서 목적:** 전투 시스템 상세 기획 명세서 (전투 공식, 스킬, 상태이상, 경험치, 자동사냥 AI)

---

## 📋 목차

1. [개요](#1-개요)
2. [전투 공식](#2-전투-공식)
3. [스킬 시스템](#3-스킬-시스템)
4. [상태이상/특수효과 시스템](#4-상태이상특수효과-시스템)
5. [경험치 시스템](#5-경험치-시스템)
6. [자동사냥 AI 시스템](#6-자동사냥-ai-시스템)
7. [버전 히스토리](#7-버전-히스토리)

---

## 1. 개요

### 1.1 시스템 목적

어글리노스의 전투 시스템은 턴제 RPG 방식을 기반으로 하며, 캐릭터와 최대 3마리의 페트가 함께 전투에 참여합니다. 본 문서는 전투에 필요한 공식, 스킬, 상태이상, 경험치 배분, 자동사냥 AI의 상세 기획을 정의합니다.

### 1.2 전투 참여 구성

| 역할 | 설명 | 최대 수 | 전투 참여 |
|------|------|---------|:---------:|
| 캐릭터 | 플레이어 본인 | 1 | ✅ |
| 탑승 페트 | 캐릭터에게 스탯 보너스 제공 | 1 | ❌ (스탯만 제공) |
| 대표 페트 | 주력 전투 페트 | 1 | ✅ |
| 대기 페트 1~2 | 보조 전투 페트 | 2 | ✅ |

### 1.3 어드민 연동 원칙

- **스킬**: 어드민 스킬DB에서 등록된 데이터 기반 동작
- **상태이상**: 어드민 상태이상DB에서 등록된 효과 조합으로 동작
- **스테이지**: 어드민 스테이지 설정의 드랍 테이블, 스톤 범위, 페트 출현 확률 사용
- **모든 수치**: 어드민에서 입력한 값을 그대로 사용

---

## 2. 전투 공식

### 2.1 기본 데미지 공식

> 💡 스톤에이지 시스템 참조

```
기본 데미지 = (ATK × 2) - (DEF × 1.5)
```

| 변수 | 설명 |
|------|------|
| ATK | 공격자의 최종 공격력 |
| DEF | 방어자의 최종 방어력 |

#### 최소 데미지 보장

```
if (기본 데미지 < 1) then 기본 데미지 = 1
```

### 2.2 스킬 데미지 공식

```
스킬 데미지 = 기본 데미지 × 스킬 배율 × 속성 배율 × 크리티컬 배율
```

| 변수 | 설명 | 출처 |
|------|------|------|
| 스킬 배율 | 스킬별 데미지 배율 (%) | 어드민 스킬DB |
| 속성 배율 | 속성 상성에 따른 배율 | 아래 상세 |
| 크리티컬 배율 | 크리티컬 시 적용 | 아래 상세 |

### 2.3 속성 상성 시스템

#### 순환 상성 (지→수→화→풍→지)

```
지(地) → 수(水) → 화(火) → 풍(風) → 지(地)
```

| 공격 속성 | 유리 (→) | 불리 (←) |
|----------|:--------:|:--------:|
| 지 | 수 | 풍 |
| 수 | 화 | 지 |
| 화 | 풍 | 수 |
| 풍 | 지 | 화 |

#### 속성 배율

| 상성 | 배율 | 설명 |
|------|:----:|------|
| 유리 | 1.3x | 30% 추가 데미지 |
| 동일/무관 | 1.0x | 데미지 변동 없음 |
| 불리 | 0.7x | 30% 데미지 감소 |

### 2.4 크리티컬 시스템

#### 크리티컬 발동 조건

```
크리티컬 확률 = 기본 확률(10%) + 스킬 크리티컬 보정 + 버프 보정
```

#### 크리티컬 효과

| 항목 | 값 | 설명 |
|------|:--:|------|
| 기본 배율 | 1.5x | 데미지 50% 증가 |
| 방어력 무시 | 100% | DEF 계산 제외 |

```
크리티컬 데미지 = ATK × 2 × 스킬 배율 × 속성 배율 × 1.5
※ 방어력(DEF) 완전 무시
```

### 2.5 탑승 스탯 합산 공식

> 💡 스톤에이지 70% 시스템 참조

캐릭터가 페트를 탑승하면 페트 스탯의 일부가 캐릭터에게 합산됩니다.

| 스탯 | 합산 비율 | 설명 |
|------|:---------:|------|
| ATK (공격력) | 70% | 페트 ATK × 0.7 추가 |
| DEF (방어력) | 70% | 페트 DEF × 0.7 추가 |
| SPD (순발력) - 캐릭터 | 20% | 캐릭터 SPD 비중 |
| SPD (순발력) - 페트 | 80% | 페트 SPD 비중 |

#### 탑승 시 최종 스탯 계산

```
최종 ATK = 캐릭터 ATK + (탑승 페트 ATK × 0.7)
최종 DEF = 캐릭터 DEF + (탑승 페트 DEF × 0.7)
최종 SPD = (캐릭터 SPD × 0.2) + (탑승 페트 SPD × 0.8)
```

### 2.6 행동 순서 결정

#### 순발력 기반 정렬

```
행동 순서 = 모든 전투 참여자의 SPD 내림차순 정렬
```

#### 동일 순발력 처리

| 우선순위 | 기준 |
|:--------:|------|
| 1 | 플레이어 측 우선 |
| 2 | 캐릭터 > 대표 페트 > 대기1 > 대기2 |
| 3 | 랜덤 |

### 2.7 다굴 (합공) 시스템

#### 발동 조건

아군이 같은 대상을 공격할 때, **순발력 차이**가 임계값 이내면 동시 공격

```
다굴 발동 조건:
1. 같은 대상 지정
2. 공격 행동 선택 (방어, 스킬 제외)
3. |아군1 SPD - 아군2 SPD| ≤ 순발력 임계값
```

| 설정 | 기본값 | 어드민 설정 |
|------|:------:|:-----------:|
| 순발력 임계값 | 20 | 가능 |
| 최대 참여 인원 | 4명 | 고정 |

#### 다굴 데미지 계산

```
다굴 데미지 = Σ(각 참여자의 개별 데미지)
※ 데미지는 합산되어 한 번에 적용
※ 기절 판정은 합산 데미지 기준
```

### 2.8 회피/명중 시스템

#### 기본 명중률

```
명중률 = 스킬 기본 명중률 × (1 + SPD 차이 보정)
```

#### SPD 기반 회피율

```
회피율 = (방어자 SPD - 공격자 SPD) × 0.5%
최대 회피율: 50%
최소 회피율: 0%
```

### 2.9 반격 시스템

> → **어드민 시스템 연동**: 스킬의 공격 범위(근접/원거리) 설정

#### 반격 조건

| 조건 | 상세 |
|------|------|
| 공격 범위 | **근접 공격**만 반격 가능 (원거리 불가) |
| 방어 상태 | 방어 행동 선택 시 |
| 생존 상태 | HP > 0 |

#### 반격 확률

```
반격 확률 = 기본 확률(10%) + 버프 보정
※ 버프 보정은 상태이상DB의 "반격 확률 증가" 효과
```

#### 반격 데미지

```
반격 데미지 = 기본 공격 데미지 × 0.5
```

---

## 3. 스킬 시스템

### 3.1 스킬 데이터 구조 (어드민 연동)

> → **어드민 시스템 연동**: 스킬DB에서 등록된 데이터 사용

| 필드 | 타입 | 설명 | 어드민 항목 |
|------|------|------|------------|
| skill_id | String | 고유 식별자 | 자동 생성 |
| name | String | 스킬명 | 스킬명 |
| type | Enum | 물리/속성 | 타입 |
| element | Enum | 지/수/화/풍 | 속성 |
| range | Enum | 근접/원거리 | 공격 범위 |
| damage_rate | Float | 데미지 배율 | 스킬값 |
| accuracy | Float | 명중률 | 명중률 |
| crit_bonus | Float | 크리티컬 보정 | 크리티컬 보정 |
| cooldown | Int | 쿨타임 (턴) | 쿨타임 |
| target | Enum | 대상 범위 | 대상 |
| effects | Array | 상태이상 연결 | 상태이상/특수효과 |

### 3.2 스킬 타입별 특성

| 타입 | 속성 적용 | DEF 계산 | 비고 |
|------|:---------:|:--------:|------|
| 물리 | ❌ | 적용 | 기본 공격력 기반 |
| 속성 | ✅ | 적용 | 속성 상성 배율 적용 |

### 3.3 스킬 대상 범위

| 대상 | 설명 |
|------|------|
| 적 단일 | 적 1체 지정 |
| 적 전체 | 적 모두 (데미지 분산 없음) |
| 아군 단일 | 아군 1체 지정 |
| 아군 전체 | 아군 모두 |
| 자신 | 스킬 사용자 |

### 3.4 스킬 쿨타임 관리

```
쿨타임 시작: 스킬 사용 직후
쿨타임 감소: 매 턴 종료 시 -1
재사용 가능: 쿨타임 = 0
```

---

## 4. 상태이상/특수효과 시스템

### 4.1 상태이상 데이터 구조 (어드민 연동)

> → **어드민 시스템 연동**: 상태이상DB에서 등록된 데이터 사용

| 필드 | 타입 | 설명 | 어드민 항목 |
|------|------|------|------------|
| effect_id | String | 고유 식별자 | 자동 생성 |
| name | String | 효과명 | 효과명 |
| description | String | 설명 | 설명 |
| icon | Image | 아이콘 | 아이콘 |
| trigger | Enum | 발동 시점 | 트리거 타이밍 |
| effects | Array | 효과 목록 | 효과 설정 |
| invalid_conditions | Array | 무효 조건 | 무효 조건 |
| stack_rule | Object | 중첩 규칙 | 중첩 규칙 설정 |

### 4.2 트리거 타이밍

> → **어드민 시스템 연동**: 효과 발동 시점 결정

| 트리거 | 발동 시점 | 예시 |
|--------|----------|------|
| TURN_START | 턴 시작 시 | 독/화상 데미지 |
| TURN_END | 턴 종료 시 | 재생 회복 |
| ON_HIT | 피격 시 | 반사 데미지 |
| ON_ATTACK | 공격 시 | 흡혈 |
| ON_DEFEND | 방어 시 | 반격 확률 증가 |
| ON_CHARACTER_HIT | 캐릭터 피격 시 | 페트 대신 맞기 |
| ON_MAGIC_USE | 주술 사용 시 | MP 추가 소모 |
| ON_ITEM_USE | 아이템 사용 시 | 효과 증폭 |
| ON_PET_SWITCH | 페트 교체 시 | 교체 후 버프 |

### 4.3 효과 처리 로직

```javascript
// 턴 시작 시 효과 처리
function processTurnStartEffects(unit) {
    for (effect of unit.activeEffects) {
        if (effect.trigger === 'TURN_START') {
            // 턴 대기 체크
            if (effect.delayTurns > 0) {
                effect.delayTurns--;
                continue;
            }
            
            // 발동 확률 체크
            if (Math.random() * 100 > effect.procChance) {
                continue;
            }
            
            // 무효 조건 체크
            if (checkInvalidConditions(effect, currentAction)) {
                continue;
            }
            
            // 효과 적용
            applyEffect(effect, unit);
            
            // 지속 턴 감소
            effect.remainingTurns--;
            if (effect.remainingTurns <= 0) {
                removeEffect(unit, effect);
            }
        }
    }
}
```

### 4.4 중첩 규칙 처리

> → **어드민 시스템 연동**: 중첩 규칙 설정

#### 동일 효과 중첩

| 규칙 | 동작 |
|------|------|
| 중첩 가능 | 스택 쌓임 (최대 스택까지) |
| 중첩 불가능 | 지속시간만 갱신 |

#### 다른 효과와의 관계

| 규칙 | 동작 |
|------|------|
| 함께 중첩 가능 | 여러 효과 동시 적용 |
| 다른효과시 삭제 | 상충 효과 부여 시 기존 효과 제거 |

```javascript
// 효과 중첩 처리
function applyStatusEffect(unit, newEffect) {
    const existingEffect = unit.findEffect(newEffect.id);
    
    if (existingEffect) {
        if (newEffect.stackRule.sameEffectStackable) {
            // 스택 증가
            existingEffect.stacks = Math.min(
                existingEffect.stacks + 1,
                newEffect.stackRule.maxStacks
            );
        } else {
            // 지속시간만 갱신
            existingEffect.remainingTurns = newEffect.duration;
        }
    } else {
        // 상충 효과 체크
        if (!newEffect.stackRule.canStackWithOthers) {
            for (conflictId of newEffect.stackRule.conflictEffects) {
                unit.removeEffect(conflictId);
            }
        }
        unit.addEffect(newEffect);
    }
}
```

### 4.5 주요 상태이상 예시

| 효과명 | 트리거 | 동작 | 지속 |
|--------|--------|------|:----:|
| 독 | TURN_START | HP 5% 감소 | 3턴 |
| 화상 | TURN_START | HP 8% 감소, DEF -10% | 2턴 |
| 빙결 | - | 행동 불가 | 1턴 |
| 혼란 | ON_ATTACK | 타겟 랜덤 | 2턴 |
| 도발 | ON_ATTACK | 특정 대상만 공격 가능 | 3턴 |
| 반사 | ON_HIT | 받은 데미지 30% 반사 | 2턴 |
| 흡혈 | ON_ATTACK | 준 데미지 20% 회복 | 3턴 |

---

## 5. 경험치 시스템

### 5.1 기본 경험치 획득

전투 승리 시 기본 경험치가 발생하며, 역할별로 배분됩니다.

```
기본 경험치 = 적 총 레벨 × 스테이지 경험치 계수
```

### 5.2 솔로 플레이 경험치 배분

| 역할 | 배분률 | 비고 |
|------|:------:|------|
| 캐릭터 | 50% | 항상 적용 |
| 탑승 페트 | 25% | 탑승 시에만 적용 |
| 대표 페트 | 50% | 전투 참여 시 |
| 대기 페트 1 | 30% | 전투 참여 시 |
| 대기 페트 2 | 30% | 전투 참여 시 |
| 휴식 페트 | 0% | 경험치 없음 |

#### 솔로 경험치 계산 예시

```
기본 경험치 = 1000

캐릭터:   1000 × 0.50 = 500 exp
탑승 페트: 1000 × 0.25 = 250 exp (탑승 시)
대표 페트: 1000 × 0.50 = 500 exp
대기1:    1000 × 0.30 = 300 exp
대기2:    1000 × 0.30 = 300 exp
```

### 5.3 파티 플레이 경험치 배분

파티 플레이 시 **추가 경험치 보너스**가 적용됩니다.

| 파티 인원 | 추가 보너스 | 누적 보너스 |
|:---------:|:-----------:|:-----------:|
| 1명 (솔로) | +0% | 0% |
| 2명 | +5% | +5% |
| 3명 | +5% | +10% |
| 4명 | +5% | +15% |
| 5명 | +5% | +20% (최대) |

```
파티 경험치 = 기본 경험치 × (1 + 파티 보너스)
```

#### 파티 경험치 계산 예시 (4인 파티)

```
기본 경험치 = 1000
파티 보너스 = +15%
파티 경험치 = 1000 × 1.15 = 1150

캐릭터:   1150 × 0.50 = 575 exp
탑승 페트: 1150 × 0.25 = 287 exp (탑승 시)
대표 페트: 1150 × 0.50 = 575 exp
대기1:    1150 × 0.30 = 345 exp
대기2:    1150 × 0.30 = 345 exp
```

### 5.4 탑승 페트 미장착 시

탑승 페트가 없는 경우, **탑승 페트 경험치는 발생하지 않습니다.**

```
탑승 페트 없음 → 탑승 페트 경험치 = 0
※ 다른 역할의 경험치에 영향 없음
```

### 5.5 레벨업 필요 경험치

| 레벨 구간 | 필요 경험치 공식 |
|----------|-----------------|
| 1~10 | Lv × 100 |
| 11~30 | Lv × 150 + 500 |
| 31~50 | Lv × 200 + 2000 |
| 51~80 | Lv × 300 + 5000 |
| 81~100 | Lv × 500 + 12000 |

---

## 6. 자동사냥 AI 시스템

### 6.1 개요

유저가 설정한 행동 패턴에 따라 전투를 자동으로 진행하는 시스템입니다.

### 6.2 자동사냥 설정 UI

```
┌─────────────────────────────────────────────────────────────────┐
│ 【자동사냥 설정】                                    [저장] [x]  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ ◉ 자동사냥 ON    ○ 자동사냥 OFF                                │
│                                                                 │
│ ┌──────────────┬──────────────┬──────────────┐                 │
│ │  전투행동    │    아이템    │    포획      │                 │
│ └──────────────┴──────────────┴──────────────┘                 │
└─────────────────────────────────────────────────────────────────┘
```

### 6.3 전투행동 탭

유닛별 (캐릭터, 대표, 대기1, 대기2) 기본 행동 설정

```
┌─────────────────────────────────────────────────────────────────┐
│ ▼ 캐릭터                                                        │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 처음 모션: ○ 공격  ○ 방어  ○ 주술 [주술 목록 ▼]            │ │
│ │ 연속 모션: ○ 공격  ○ 방어  ○ 주술 [주술 목록 ▼]            │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ▼ 대표 페트                                                     │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 처음 모션: ○ 공격  ○ 방어  ○ 스킬 [스킬 목록 ▼]            │ │
│ │ 연속 모션: ○ 공격  ○ 방어  ○ 스킬 [스킬 목록 ▼]            │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ▼ 대기1 페트                                                    │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 처음 모션: ○ 공격  ○ 방어  ○ 스킬 [스킬 목록 ▼]            │ │
│ │ 연속 모션: ○ 공격  ○ 방어  ○ 스킬 [스킬 목록 ▼]            │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ▼ 대기2 페트                                                    │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 처음 모션: ○ 공격  ○ 방어  ○ 스킬 [스킬 목록 ▼]            │ │
│ │ 연속 모션: ○ 공격  ○ 방어  ○ 스킬 [스킬 목록 ▼]            │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**스킬 드롭다운:** 해당 페트가 현재 보유한 스킬 목록만 표시  
**주술 드롭다운:** 캐릭터가 현재 보유한 주술 목록만 표시

### 6.4 아이템 탭

자동 HP/MP 회복 아이템 사용 설정

```
┌─────────────────────────────────────────────────────────────────┐
│ 【아이템】                                                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ ▼ 자동 HP 회복                                                  │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ ☐ 사용                                                       │ │
│ │ HP 임계값: [  30  ] % 이하일 때 사용                         │ │
│ │ 사용 아이템: [HP 회복 아이템 목록 ▼]                         │ │
│ │                                                              │ │
│ │ 대상 설정:                                                   │ │
│ │ ☑ 자신 (캐릭터)                                              │ │
│ │ ☑ 페트 (내 페트)                                             │ │
│ │ ☐ 아군 (파티원 캐릭터/페트)                                  │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ▼ 자동 MP 회복                                                  │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ ☐ 사용                                                       │ │
│ │ MP 임계값: [  20  ] % 이하일 때 사용                         │ │
│ │ 사용 아이템: [MP 회복 아이템 목록 ▼]                         │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ▼ 자동 판매 설정                                                │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ ☐ 재료 아이템 자동 판매                                      │ │
│ │ ☐ 고기 아이템 자동 판매                                      │ │
│ │                                                              │ │
│ │ ※ 어드민에서 "재료", "고기" 타입으로 설정된 아이템 대상     │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 6.5 포획 탭

자동 포획 설정

```
┌─────────────────────────────────────────────────────────────────┐
│ 【포획】                                                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ ▼ 포획 모드                                                     │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ ○ 포획 OFF (전투만 진행)                                     │ │
│ │ ◉ 포획 ON (1레벨 페트 출현 시 자동 포획)                     │ │
│ │                                                              │ │
│ │ ※ 1레벨 페트 출현 확률: 스테이지별 어드민 설정 참조         │ │
│ │ ※ 포획 성공률: 별도 공식 적용                               │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ▼ 포획 우선순위                                                 │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ [속성 우선] ▼                                                │ │
│ │  ├── 속성 우선 (유리 속성 먼저)                              │ │
│ │  ├── HP 낮은 순                                              │ │
│ │  └── 랜덤                                                    │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ▼ 포획 대상 필터                                                │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ ☑ 지속성 페트 포획                                           │ │
│ │ ☑ 수속성 페트 포획                                           │ │
│ │ ☑ 화속성 페트 포획                                           │ │
│ │ ☑ 풍속성 페트 포획                                           │ │
│ │                                                              │ │
│ │ 특정 페트 제외:                                              │ │
│ │ [페트 목록에서 선택 ▼] [+ 추가]                              │ │
│ │ ┌─────────────────────────────────────────────────────────┐ │ │
│ │ │ (제외 목록 없음)                                         │ │ │
│ │ └─────────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 6.6 자동사냥 AI 로직

```javascript
// 자동사냥 AI 메인 로직
function autoHuntAI(unit, settings, battleState) {
    // 1. 아이템 자동 사용 체크
    if (settings.autoHeal.enabled) {
        const healTarget = findHealTarget(unit, settings);
        if (healTarget && shouldUseHealItem(healTarget, settings)) {
            return { action: 'ITEM', target: healTarget, item: settings.autoHeal.item };
        }
    }
    
    // 2. 포획 모드 체크 (1레벨 페트 출현 시)
    if (settings.capture.enabled && battleState.hasLevel1Pet) {
        const captureTarget = findCaptureTarget(battleState, settings);
        if (captureTarget) {
            return { action: 'CAPTURE', target: captureTarget };
        }
    }
    
    // 3. 전투 행동 결정
    const isFirstTurn = battleState.turnCount === 1;
    const actionSetting = isFirstTurn 
        ? settings.actions[unit.role].firstAction 
        : settings.actions[unit.role].repeatAction;
    
    // 4. 타겟 선택 (다굴 고려)
    const target = selectTarget(battleState, settings);
    
    // 5. 행동 반환
    switch (actionSetting.type) {
        case 'ATTACK':
            return { action: 'ATTACK', target: target };
        case 'DEFEND':
            return { action: 'DEFEND' };
        case 'SKILL':
            return { action: 'SKILL', skill: actionSetting.skillId, target: target };
        case 'MAGIC':
            return { action: 'MAGIC', magic: actionSetting.magicId, target: target };
    }
}
```

### 6.7 포획 시스템

> → **어드민 시스템 연동**: 스테이지별 1레벨 페트 출현 확률

#### 1레벨 페트 출현 규칙

| 규칙 | 설명 |
|------|------|
| 출현 조건 | 스테이지 시작 시 확률 판정 |
| 출현 확률 | 어드민 스테이지 설정 참조 |
| 최대 출현 수 | 2마리 |
| 출현 페트 | 스테이지 "포획 가능 페트" 중 랜덤 |
| 혼합 출현 | 불가 (1레벨 페트 or 일반 적만 출현) |

#### 포획 성공률

```
포획 성공률 = 기본 확률(50%) + (잔여 HP에 따른 보정)

HP 보정:
- HP 100%~51%: -30%
- HP 50%~26%: +0%
- HP 25%~11%: +20%
- HP 10% 이하: +40%
```

### 6.8 전투 결과 및 보상

> → **어드민 시스템 연동**: 스테이지별 드랍 테이블, 스톤 드랍 범위

#### 결과 화면 구성

| 항목 | 데이터 출처 |
|------|-------------|
| 승리/패배 | 전투 로직 |
| 경험치 + 레벨업 | 경험치 시스템 |
| 퀘스트 달성 | 어드민 퀘스트 연동 |
| 포획 페트 | 포획 시스템 |
| 획득 아이템 | 어드민 드랍테이블 |
| 스톤 | 어드민 스테이지 설정 |

#### 스톤 드랍

```
획득 스톤 = Random(최소값, 최대값)
※ 최소~최대 값은 어드민 스테이지 설정
```

#### 아이템 드랍

- 각 플레이어에게 **개별 드랍** (파티 시 각자 분배 아님)
- 드랍 테이블은 어드민 스테이지 설정 참조

#### 퀘스트 달성

- 달성 시 **1회에 한하여** 신규 달성 표시
- 이미 달성한 퀘스트는 달성된 상태(별 활성화) 유지

---

## 7. 버전 히스토리

### v1.4 (현재)

| 항목 | 변경 내용 |
|------|-----------|
| 전투 공식 | 스톤에이지 기반 데미지 공식 정립 (ATK×2 - DEF×1.5) |
| 탑승 스탯 | 스톤에이지 70% 시스템 적용 (ATK/DEF 70%, SPD 20%/80%) |
| 크리티컬 | 방어력 완전 무시 + 1.5배 데미지 |
| 속성 상성 | 순환 상성 및 배율 (1.3x/1.0x/0.7x) 정립 |
| 다굴 시스템 | 순발력 기반 합공 조건 정립 |
| 반격 시스템 | 근접 공격만 반격 가능 (어드민 공격 범위 연동) |
| 경험치 | 솔플/파티 배분률 정립 (파티 +5%/인원, 최대 +20%) |
| 자동사냥 | 전투행동/아이템/포획 3탭 구조, AI 로직 정의 |

### v1.3

| 항목 | 변경 내용 |
|------|-----------|
| 어드민 연동 | 스킬/상태이상 DB 연동 구조 정립 |
| 상태이상 | 트리거 타이밍, 중첩 규칙 시스템 추가 |

### v1.2

| 항목 | 변경 내용 |
|------|-----------|
| 스킬 시스템 | 어드민 스킬DB 연동 구조 |
| 상태이상 | 어드민 상태이상DB 연동 구조 |

### v1.1

| 항목 | 변경 내용 |
|------|-----------|
| 기본 구조 | 전투 참여 구성 정의 |

### v1.0

| 항목 | 변경 내용 |
|------|-----------|
| 초기 작성 | 문서 생성 |

---

## 📌 문서 연동 참조

### 전투 시스템 ↔ 어드민 시스템 연동 항목

| 전투 시스템 항목 | 어드민 시스템 참조 | 어드민 문서 섹션 |
|-----------------|-------------------|-----------------|
| 스킬 데이터 | 스킬DB | 4. 스킬 관리 |
| 공격 범위 (반격 조건) | 스킬 - 공격 범위 | 4.2 |
| 상태이상 효과 | 상태이상DB | 5. 상태이상/특수효과 관리 |
| 트리거 타이밍 | 상태이상 - 트리거 | 5.3 |
| 중첩 규칙 | 상태이상 - 중첩 규칙 | 5.6 |
| 무효 조건 | 상태이상 - 무효 조건 | 5.5 |
| 스톤 드랍 범위 | 스테이지 - 스톤 드랍 | 8.3 |
| 1레벨 페트 출현 | 스테이지 - 1레벨 페트 설정 | 8.4 |
| 드랍 테이블 | 스테이지 - 드랍 테이블 | 8.2 |
| 아이템 자동판매 | 아이템DB - 타입 | 9.2 |

---

*문서 끝*
